<?xml version="1.0" encoding="UTF-8"?>
<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <rules css:if-content="#visual-portal-wrapper">

        <theme href="plonetheme.html" />

        <!-- Head elements -->
        <replace css:theme="html head title"
                 css:content="html head title" />
        <after css:theme-children="html head"
               css:content="html head meta" />
        <after css:theme-children="html head"
               css:content="html head base" />

        <!-- Logo -->
        <copy attributes="href"
              css:theme=".brand"
              css:content="#portal-logo" />

        <!-- Global navigation -->
        <replace css:theme-children="#globalnav .nav"
                 css:content-children="#portal-globalnav"
                 css:if-content="#portal-globalnav" />

        <!-- Search -->
        <copy attributes="action" css:theme="#global-nav-search" css:content="#portal-searchbox form" />
        <copy attributes="name" css:theme="#searchbox .search-query" css:content="#portal-searchbox form .searchField" />

        <!-- Personal tools -->
        <replace css:theme="#account a.dropdown-toggle"
                 css:content="#portal-personaltools li#anon-personalbar a"
                 css:if-content= "#portal-personaltools li#anon-personalbar a" />
        <replace css:theme-children="#account a.dropdown-toggle"
                 css:content-children="#portal-personaltools .actionMenuHeader a#user-name"
                 css:if-content="#portal-personaltools .actionMenuHeader a#user-name" />
        <before css:theme-children="#account a.dropdown-toggle"
                method="raw">
            <i class="icon-user"></i>
        </before>
        <after css:theme-children="#account a.dropdown-toggle"
                method="raw">
            <b class="caret"></b>
        </after>
        <replace css:theme-children="#account ul.dropdown-menu"
                 css:content-children="#portal-personaltools dd.actionMenuContent ul"
                 css:if-content="#portal-personaltools dd.actionMenuContent" />

        <!-- Breadcrumbs -->
        <drop css:theme="ul.breadcrumb"
              css:if-not-content="#portal-breadcrumbs" />
        <replace css:theme=".breadcrumb li.home a"
                 css:content="#portal-breadcrumbs span#breadcrumbs-home a"
                 css:if-content="#portal-breadcrumbs span#breadcrumbs-home a" />
        <drop css:theme=".breadcrumb li.home"
              css:if-not-content="#portal-breadcrumbs span#breadcrumbs-home" />
        <replace css:theme=".breadcrumb li.breadcrumbs-1 a"
                 css:content="#portal-breadcrumbs span#breadcrumbs-1 a"
                 css:if-content="#portal-breadcrumbs span#breadcrumbs-1 a" />
        <drop css:theme=".breadcrumb li.breadcrumbs-1"
              css:if-not-content="#portal-breadcrumbs span#breadcrumbs-2" />
        <replace css:theme=".breadcrumb li.breadcrumbs-2 a"
                 css:content="#portal-breadcrumbs span#breadcrumbs-2 a"
                 css:if-content="#portal-breadcrumbs span#breadcrumbs-2 a" />
        <drop css:theme=".breadcrumb li.breadcrumbs-2"
              css:if-not-content="#portal-breadcrumbs span#breadcrumbs-3" />
        <replace css:theme=".breadcrumb li.breadcrumbs-3 a"
                 css:content="#portal-breadcrumbs span#breadcrumbs-3 a"
                 css:if-content="#portal-breadcrumbs span#breadcrumbs-3 a" />
        <drop css:theme=".breadcrumb li.breadcrumbs-3"
              css:if-not-content="#portal-breadcrumbs span#breadcrumbs-4" />
        <replace css:theme=".breadcrumb li.breadcrumbs-4 a"
                 css:content="#portal-breadcrumbs span#breadcrumbs-4 a"
                 css:if-content="#portal-breadcrumbs span#breadcrumbs-4 a" />
        <drop css:theme=".breadcrumb li.breadcrumbs-4"
              css:if-not-content="#portal-breadcrumbs span#breadcrumbs-5" />
        <replace css:theme=".breadcrumb li.breadcrumbs-5 a"
                 css:content="#portal-breadcrumbs span#breadcrumbs-1 a"
                 css:if-content="#portal-breadcrumbs span#breadcrumbs-5 a" />
        <drop css:theme=".breadcrumb li.breadcrumbs-5"
              css:if-not-content="#portal-breadcrumbs span#breadcrumbs-6" />
        <replace css:theme=".breadcrumb li.breadcrumbs-6 a"
                 css:content="#portal-breadcrumbs span#breadcrumbs-6 a"
                 css:if-content="#portal-breadcrumbs span#breadcrumbs-6 a" />
        <drop css:theme=".breadcrumb li.breadcrumbs-6"
              css:if-not-content="#portal-breadcrumbs span#breadcrumbs-7" />
        <replace css:theme=".breadcrumb li.breadcrumbs-7 a"
                 css:content="#portal-breadcrumbs span#breadcrumbs-7 a"
                 css:if-content="#portal-breadcrumbs span#breadcrumbs-7 a" />
        <drop css:theme=".breadcrumb li.breadcrumbs-7"
              css:if-not-content="#portal-breadcrumbs span#breadcrumbs-8" />
        <replace css:theme=".breadcrumb li.active"
                 css:content="#portal-breadcrumbs span#breadcrumbs-current"
                 css:if-content="#portal-breadcrumbs span#breadcrumbs-home a" />

        <!-- Edit bar -->
        <drop css:theme=".editable"
              css:if-not-content=".documentEditable" />

        <!-- File -->
        <replace css:theme-children="#file > a"
                 css:content-children="#edit-bar p:first-of-type"
                 css:if-content="#edit-bar p" />
        <after css:theme-children="#file > a"
                method="raw">
            <b class="caret"></b>
        </after>
        <replace css:theme-children="#file ul.dropdown-menu"
                 css:content-children="#content-views"
                 css:if-content="#content-views" />
        <drop css:theme="#file"
              css:if-not-content="#content-views" />

        <!-- Add -->
        <replace css:theme-children="#add > a"
                 css:content-children="#plone-contentmenu-factories dt.actionMenuHeader a span:first-of-type"
                 css:if-content="#plone-contentmenu-factories dt.actionMenuHeader a span" />
        <after css:theme-children="#add > a"
                method="raw">
            <b class="caret"></b>
        </after>
        <replace css:theme-children="#add ul.dropdown-menu li"
                 css:content-children="#plone-contentmenu-factories dd ul"
                 css:if-content="#plone-contentmenu-factories" />
        <drop css:theme="#add"
              css:if-not-content="#plone-contentmenu-factories" />

        <!-- Edit -->
        <replace css:theme-children="#edit > a"
                 css:content-children="#plone-contentmenu-actions dt.actionMenuHeader a span:first-of-type"
                 css:if-content="#plone-contentmenu-actions dt.actionMenuHeader a span" />
        <after css:theme-children="#edit > a"
                method="raw">
            <b class="caret"></b>
        </after>
        <replace css:theme-children="#edit ul.dropdown-menu li"
                 css:content-children="#plone-contentmenu-actions dd ul"
                 css:if-content="#plone-contentmenu-actions" />
        <drop css:theme="#edit"
              css:if-not-content="#plone-contentmenu-actions" />

        <!-- Display -->
        <replace css:theme-children="#display > a"
                 css:content-children="#plone-contentmenu-display dt.actionMenuHeader a span:first-of-type"
                 css:if-content="#plone-contentmenu-display dt.actionMenuHeader a span" />
        <after css:theme-children="#display > a"
                method="raw">
            <b class="caret"></b>
        </after>
        <replace css:theme-children="#display ul.dropdown-menu li"
                 css:content-children="#plone-contentmenu-display dd ul"
                 css:if-content="#plone-contentmenu-display" />
        <drop css:theme="#display"
              css:if-not-content="#plone-contentmenu-display" />

        <!-- State -->
        <replace css:theme-children="#state > a"
                 css:content-children="#plone-contentmenu-workflow dt.actionMenuHeader a span:first-of-type"
                 css:if-content="#plone-contentmenu-workflow dt.actionMenuHeader a span" />
        <after css:theme-children="#state > a"
               method="raw">
            <b class="caret"></b>
        </after>
        <replace css:theme-children="#state ul.dropdown-menu li"
                 css:content-children="#plone-contentmenu-workflow dd ul"
                 css:if-content="#plone-contentmenu-workflow" />
        <drop css:theme="#state"
              css:if-not-content="#plone-contentmenu-workflow" />


        <!-- Portal messages -->

        <!-- Columns -->
        <replace css:content=".portletNavigationTree .navTreeLevel0 > li > a"
                 css:theme=".sidenav li a"
                 css:if-content=".portletNavigationTree .navTreeLevel0 > li > a" />
        <drop css:theme=".sidenav"
              css:if-not-content=".portletNavigationTree .navTreeLevel0 > li > a" />
        <replace css:content-children="#content"
                 css:theme-children="#content" />

        <!-- Footer -->
        <replace css:theme-children=".modal-footer .container .copyright"
                 css:content-children="#portal-footer p" />
        <replace css:theme-children=".modal-footer .container ul.footer-links"
                 css:content-children="#portal-siteactions" />

    </rules>

</rules>

